{% extends "templates/web.html" %}
{% block title %}
    {{ _("Job Openings") }}
{% endblock title %}
{% block header %}
    <h3 class="mt-0 mb-10">{{ _("Job Openings") }}</h3>
{% endblock header %}
{% block page_content %}
    <div class="row">
        <div class="col-3 md-text">
            <div class="mb-10 flex align-items-center">
                <p class="lg-text font-weight-bold">{{ _("Filters") }}</p>
                <a id="clear-filters" class="ml-auto sm-text" role="button">{{ _("Clear All") }}</a>
            </div>
            {% for name, values in all_filters.items() %}
                <div class="mb-10">
                    <p class="font-weight-bold mb-4">{{ name.title() | replace('_', ' ') }}</p>
                    {% for value in values %}
                        <div class="form-group form-check">
                            <input type="checkbox"
                                   name="{{ name }}"
                                   class="form-check-input"
                                   id="{{ value }}"
                                   value="{{ value }}"
                                   role="button">
                            <label class="form-check-label" for="{{ value }}"  role="button">{{ value }}</label>
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
        <div class="col-9">
            <div class="row px-4 mb-12 ">
                <div class="col-8 pl-0">
                    <input type="search"
                           name="query"
                           id="search-box"
                           class="form-control border font-md"
                           placeholder="Search for Jobs"
                           aria-label="Jobs Search"
                           style="height: 40px">
                    <div class="search-icon">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             width="16"
                             height="16"
                             viewBox="0 0 24 24"
                             fill="none"
                             stroke="currentColor"
                             stroke-width="2"
                             stroke-linecap="round"
                             stroke-linejoin="round"
                             class="feather feather-search">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                    </div>
                </div>
                <div class="col-4 flex pr-0">
                    <div class="ml-auto flex align-items-center">
                        <div class="md-text text-secondary flex"
                             type="button"
                             data-toggle="dropdown"
                             aria-haspopup="true"
                             aria-expanded="false">
                            Sort by:
                            <div class="font-weight-bold ml-3">
                                {{ order_by }}
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="10"
                                     height="10"
                                     fill="currentColor"
                                     stroke="currentColor"
                                     stroke-width="3"
                                     class="bi bi-chevron-down"
                                     viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" />
                                </svg>
                            </div>
                        </div>
                        <div class="dropdown-menu border" aria-labelledby="dropdownMenuButton">
                            {% for sort in ["Newest Post", "Oldest Post", "Earliest Closing", "Latest Closing"] %}
                                <a name="sort" class="dropdown-item text-secondary">{{ sort }}</a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <p class="text-secondary mb-4 md-text">Showing {{ job_openings|length }} results</p>
            {% for jo in job_openings %}
                <div class="mb-8 card border p-6">
                    <div class="flex">
                        <h3 class="mt-0 mb-3 mr-20">{{ jo.job_title }}</h3>
                        <div class="ml-auto font-weight-bold text-nowrap">
                            {%- if jo.employment_type -%}
                                {%- if jo.employment_type == "Full-time" -%}
                                    <span class="sm-text py-2 px-3 full-time-badge">• {{ jo.employment_type }}</span>
                                {%- elif jo.employment_type == "Part-time" -%}
                                    <span class="sm-text py-2 px-4 part-time-badge">• {{ jo.employment_type }}</span>
                                {%- else -%}
                                    <span class="sm-text py-2 px-4 other-badge">• {{ jo.employment_type }}</span>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <div class="mb-10">
                        <div class="flex mb-2 align-items-center primary-stroke text-secondary">
                            <svg class="icon icon-md ml-0 mr-1">
                                <use href="#icon-organization"></use>
                            </svg>
                            <p class="mr-3 ">{{ jo.company }}</p>
                            {%- if jo.department -%}
                                <svg class="icon icon-md ml-0 mr-1">
                                    <use href="#icon-branch"></use>
                                </svg>
                                <p class="mr-3 ">{{ jo.department }}</p>
                            {% endif %}
                            {%- if jo.location -%}
                                <svg class="icon icon-md ml-0 mr-1"
                                     xmlns="http://www.w3.org/2000/svg"
                                     viewBox="0 0 16 16">
                                    <g stroke="var(--primary)" stroke-miterlimit="10">
                                    <path d="M11.467 3.458c1.958 1.957 1.958 5.088.027 7.02L7.97 14l-3.523-3.523a4.945 4.945 0 010-6.993l.026-.026a4.922 4.922 0 016.993 0zm0 0c-.026-.026-.026-.026 0 0z">
                                    </path>
                                    <path d="M7.971 8.259a1.305 1.305 0 100-2.61 1.305 1.305 0 000 2.61z"></path>
                                    </g>
                                </svg>
                                <p class="mr-3 ">{{ jo.location }}</p>
                            {% endif %}
                        </div>
                        {%- if jo.publish_salary_range -%}
                            <p class="mb-2">
                                <span class="font-weight-bold lg-text">
                                    {{ frappe.format_value(frappe.utils.flt(jo.lower_range) ,
                                    currency=jo.currency) }} - {{ frappe.format_value(frappe.utils.flt(jo.upper_range) ,
                                    currency=jo.currency) }}
                                </span>
                                <span class="text-secondary">{{ jo.salary_type.lower() }}</span>
                            </p>
                        {% endif %}
                        {%- if jo.no_of_applications -%}
                            <p class="text-secondary">
                                {{ jo.no_of_applications }}
                                {{ _(" applicant" if jo.no_of_applications == 1 else " applicants") }}
                            </p>
                        {% endif %}
                    </div>
                    <div class="flex">
                        <a class="btn btn-primary" href="{{ jo.route }}">{{ _("View Job →") }}</a>
                        {%- if jo.closes_on -%}
                            <p class="ml-auto font-italic text-secondary mt-auto sm-text">
                                {{ _("Closes on " + frappe.format_date(jo.closes_on, "d MMM, YYYY") ) }}
                            </p>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock page_content %}
